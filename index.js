import{i as v,A as _}from"./assets/vendor-Bffpt9Uq.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".hero__button"),t=document.querySelector("#reviews");e&&t&&e.addEventListener("click",()=>{t.scrollIntoView({behavior:"smooth",block:"start"})})});const h=document.querySelector("[data-menu]"),L=document.querySelector("[data-menu-open]"),$=document.querySelector("[data-menu-close]"),O=document.querySelectorAll(".mobile-nav-list a, .mobile-btn");function T(){h.classList.add("is-open"),document.body.style.overflow="hidden",document.addEventListener("keydown",w),document.addEventListener("click",k)}function f(){h.classList.remove("is-open"),document.body.style.overflow="",document.removeEventListener("keydown",w),document.removeEventListener("click",k)}function w(e){e.key==="Escape"&&f()}function k(e){!h.contains(e.target)&&!L.contains(e.target)&&f()}L.addEventListener("click",T);$.addEventListener("click",f);O.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const o=e.getAttribute("href"),s=document.querySelector(o);s&&(f(),s.scrollIntoView({behavior:"smooth"}))})});const u=document.querySelector(".modal"),E=document.querySelector(".modal_close"),b=document.querySelector(".modal_main-image img"),S=document.querySelector(".modal_title"),I=document.querySelector(".modal_category"),D=document.querySelector(".modal_price"),B=document.querySelector(".modal_description"),p=document.querySelector(".modal_rate"),g=document.querySelector(".color-checkboxes"),F=document.querySelector(".modal_sizes"),c=document.querySelector(".modal_order-btn"),q=document.querySelector(".modal_thumbnails"),H=document.querySelector(".furniture-list");let m=0,a=[];function x(e){e.key==="Escape"&&y()}function M(){if(!a.length)return;b.src=a[m],b.alt=S.textContent||"Фото товару";const e=a.map((t,o)=>({src:t,i:o})).filter(({i:t})=>t!==m).map(({src:t,i:o})=>`
      <img class="thumbnail-img" src="${t}" alt="thumb ${o}" data-index="${o}">
    `).join("");q.innerHTML=e}q?.addEventListener("click",e=>{const t=e.target.closest(".thumbnail-img");t&&(m=Number(t.dataset.index),M())});H?.addEventListener("click",e=>{const t=e.target.closest(".details-btn");if(!t)return;const o=t.closest(".furniture-card");if(!o)return;const s=o.dataset.id||o.id;if(!s||!window.allFurnitures)return;const n=window.allFurnitures.find(r=>r._id===s);n&&P(n)});function P(e){if(S.textContent=e.name||"Без назви",I.textContent=e.type||"Тип невідомий",D.textContent=`${e.price} грн`||"Ціна невідома",B.textContent=e.description||"Опис відсутній",c.dataset.model=e.name||"",c.setAttribute("data-modal-open",""),c.setAttribute("data-id",e._id),c.setAttribute("data-marker","product-modal"),p&&typeof e.rate=="number"){const t=Math.round(e.rate*10)/10,o=Math.min(5,t)/5*100;p.innerHTML=`
      <div class="star-rating" style="--star-fill: ${o}%"></div>
      <span class="rating-text">${t.toFixed(1)}</span>
    `}else p.innerHTML="";g&&Array.isArray(e.color)?g.innerHTML=e.color.map((t,o)=>{const s=`color-${o}`;return`
          <input type="radio" id="${s}" name="color" data-color="${t}" ${o===0?"checked":""} />
          <label for="${s}" style="background-color: ${t}"></label>
        `}).join(""):g.innerHTML="",F.textContent=`Розміри: ${e.sizes||"невідомі"}`,a=Array.isArray(e.images)?e.images.slice():[],m=0,M(),c.dataset.id=e._id||"",u.classList.remove("visually-hidden"),E.focus(),document.body.style.overflow="hidden",document.addEventListener("keydown",x)}function y(){u.classList.add("visually-hidden"),document.body.style.overflow="",document.removeEventListener("keydown",x)}E?.addEventListener("click",y);u?.addEventListener("click",e=>{e.target===u&&y()});c.addEventListener("click",()=>{const e=document.querySelector('.color-checkboxes input[type="radio"]:checked'),t=e?e.dataset.color:null;t&&c.setAttribute("data-color",t),c.dataset.model&&c.setAttribute("data-model",c.dataset.model),y();const o=new CustomEvent("open-order-modal",{detail:{model:c.dataset.model||"",color:t}});document.dispatchEvent(o)});const j="data:image/svg+xml,%3csvg%20aria-hidden='true'%20style='position:%20absolute;%20width:%200;%20height:%200;%20overflow:%20hidden;'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3csymbol%20id='icon-x-icon'%20viewBox='0%200%2032%2032'%3e%3cpath%20d='M21.589%208.459l-5.657%205.656-5.656-5.656-1.885%201.885%205.656%205.656-5.656%205.656%201.885%201.885%205.656-5.656%205.657%205.656%201.885-1.885-5.656-5.656%205.656-5.656-1.885-1.885z'%3e%3c/path%3e%3c/symbol%3e%3c/defs%3e%3c/svg%3e";let A=null,C=null;async function z(){try{if(!document.getElementById("svg-sprite")){const d=await(await fetch(j)).text(),i=document.createElement("div");i.style.position="absolute",i.style.width="0",i.style.height="0",i.style.overflow="hidden",i.id="svg-sprite",i.innerHTML=d,document.body.prepend(i)}const t=await(await fetch("./partials/order-modal.html")).text();document.body.insertAdjacentHTML("beforeend",t);const o=document.querySelector(".backdrop"),s=document.querySelector(".modal-button-close"),n=document.querySelector(".modal-form");o&&(o.addEventListener("click",r=>{r.target===o&&l()}),document.addEventListener("keydown",r=>{r.key==="Escape"&&o.classList.contains("is-open")&&l()})),s&&s.addEventListener("click",l),n&&n.addEventListener("submit",R)}catch(e){console.error("Помилка завантаження модалки:",e)}}function l(){const e=document.querySelector(".backdrop");e&&(e.classList.remove("is-open"),document.body.style.overflow="",N())}function N(){const e=document.querySelector(".modal-form");e&&e.reset()}async function R(e){e.preventDefault();const t=e.target,o=new FormData(t),s={name:o.get("user-name"),phone:o.get("user-phone"),comment:o.get("user-comment"),furnitureId:A,marker:C};try{const n=await fetch("/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(n.ok)v.success({title:"Успіх",message:"Ваше замовлення успішно відправлено!",position:"topRight"}),l();else{const r=await n.json();throw new Error(r.message||"Помилка сервера")}}catch(n){v.error({title:"Помилка",message:n.message||"Не вдалося відправити форму",position:"topRight"})}}function V(e=!0,t=null,o=null){const s=document.querySelector(".backdrop");s&&(s.classList.toggle("is-open",e),document.body.style.overflow=e?"hidden":"",e&&(A=t,C=o))}function G(){document.addEventListener("DOMContentLoaded",()=>{new _(".accordion",{duration:300,showMultiple:!1}).open(0)})}document.addEventListener("DOMContentLoaded",()=>{z(),document.addEventListener("click",e=>{if(e.target.closest("[data-modal-open]")){const t=e.target.closest("[data-modal-open]").dataset.id,o=e.target.closest("[data-modal-open]").dataset.marker;V(!0,t,o)}})});G();
//# sourceMappingURL=index.js.map
